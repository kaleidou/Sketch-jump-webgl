<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Unity Web Player | Sketch-Jump</title>
    <link rel="shortcut icon" href="TemplateData/favicon.ico">

    <!-- 关键：移动端视口 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">

    <!-- 仅保留我们自己的样式，强制 9:16 竖屏盒子 -->
    <style>
      html, body {
        margin: 0; padding: 0;
        height: 100%; width: 100%;
        background: #111; overflow: hidden;
      }
      #unity-container {
        position: fixed; inset: 0;
        display: flex; align-items: center; justify-content: center;
      }
      /* 画布固定竖屏 9:16：高占满视口，高优先；宽按 9:16 自动 */
      #unity-canvas {
        height: 100vh !important;
        aspect-ratio: 9 / 16 !important;
        width: auto !important;
        max-height: 100vh !important;
        max-width: 100vw !important;
        display: block;
        image-rendering: auto;
      }
      /* 加载条可选（最小化） */
      #unity-loading { position: fixed; left:0; right:0; bottom:20px; text-align:center; color:#fff; font: 600 14px system-ui, Arial; }
    </style>
  </head>
  <body>
    <div id="unity-container">
      <!-- 注意：宽高属性只是初始渲染分辨率，不影响我们强制的 CSS 比例 -->
      <canvas id="unity-canvas" width="1080" height="1920" tabindex="-1"></canvas>
      <div id="unity-loading">Loading…</div>
    </div>

    <script>
      var canvas   = document.getElementById("unity-canvas");
      var buildUrl = "Build";
      var loaderUrl = buildUrl + "/SketchJump.loader.js";

      var config = {
        arguments: [],
        dataUrl:       buildUrl + "/SketchJump.data.unityweb",
        frameworkUrl:  buildUrl + "/SketchJump.framework.js.unityweb",
        codeUrl:       buildUrl + "/SketchJump.wasm.unityweb",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "DefaultCompany",
        productName: "Sketch-Jump",
        productVersion: "1.0.0",
        matchWebGLToCanvasSize: true,                   // 关键：渲染尺寸跟随 canvas
        devicePixelRatio: Math.min(2, window.devicePixelRatio || 1)
      };

      var script = document.createElement("script");
      script.src = loaderUrl;
      script.onload = function () {
        createUnityInstance(canvas, config, function (progress) {
          document.getElementById("unity-loading").textContent = Math.round(progress * 100) + "%";
        }).then(function () {
          document.getElementById("unity-loading").style.display = "none";
        }).catch(function (message) {
          alert(message);
        });
      };
      document.body.appendChild(script);
    </script>
  </body>
</html>
